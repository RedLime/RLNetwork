<!DOCTYPE html>
<html>

<head>
  <base href="https://redlime.github.io/rlnetwork/">
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:title" content="RLNetwork" /> <!-- EDIT THIS ONE -->
  <meta property="og:site_name" content="RLNetwork" /> <!-- EDIT THIS ONE -->
  <meta property="og:type" content="website" /> <!-- EDIT THIS ONE -->
  <meta property="og:url" content="https://redlime.github.io/rlnetwork/" /> <!-- EDIT THIS ONE -->
  <meta property="og:description" content="RLNetwork의 공식 사이트입니다." /> <!-- EDIT THIS ONE -->
  <meta property="og:image" content="./images/icon.png" /> <!-- EDIT THIS ONE -->
  <link rel="shortcut icon" href="./favicon.ico">
  
  <!-- End Required Meta Tags -->
  
  <!-- Start Required Links -->
  
  <!-- https://fontawesome.com/ -->
  <link rel="stylesheet" href="https://kit-free.fontawesome.com/releases/latest/css/free.min.css" media="all">
  <!-- https://bulma.io/ -->
  <link rel="stylesheet" href="./assets/css/bulma.min.css">
  <!-- Custom CSS -->
  <link rel="stylesheet" href="./assets/css/style.css">
  <link rel="stylesheet" href="./assets/css/custom.css">
  <script src="./assets/js/app.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

  <!-- Start Title -->
  <title>RLNetwork &mdash; 서버</title> <!-- EDIT THIS ONE -->
  <!-- End Title -->
</head>

<body>
<!-- Start Navbar -->
<nav id="navbar" class="navbar fixed is-transparent" role="navigation" aria-label="main navigation">
  <div class="container">
      <div class="navbar-brand">
      <!-- Start Navbar Brand -->
      <a class="navbar-item has-text-weight-bold server-name" href="./"></a>
      <!-- End Navbar Brand -->
      <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false"
          data-target="navbarBasicExample">
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
      </a>
      </div>
      <!-- Start Navbar Menu -->
      <div id="navbarBasicExample" class="navbar-menu">
      <div class="navbar-start">
          <a href="./" class="navbar-item">
          홈
          </a>
          <a href="./game" class="navbar-item">
          서버
          </a>
          <a href="./leaderboard" class="navbar-item has-text-primary">
          리더보드
          </a>
          <a href="./rank" class="navbar-item">
          등급
          </a>
          <a href="./donate" class="navbar-item">
          후원안내
          </a>
          <a href="./discord" class="navbar-item" target="_blank">
          Discord
          </a>
      </div>
      <!-- Start Navbar End -->
      <div class="navbar-end">
          <a id="ip-button" class="navbar-item">
          <strong class="has-text-primary server-ip"></strong>
          </a>
      </div>
      <!-- End Navbar End -->
      </div>
      <!-- End Navbar Menu -->
  </div>
</nav>
<!-- End Navbar -->

  <!-- Start Hero -->
  <section class="hero has-background-image is-medium">
    <div class="hero-body">
      <div class="container has-text-centered">
        <!-- Start Hero Title -->
        <p class="title is-1 has-text-white">
          리더보드
        </p>
        <!-- End Hero Title -->

        <!-- Start Hero Subtitle -->
        <p class="subtitle has-text-white">
          RLNetwork의 리더보드입니다!
        </p>
        <!-- End Hero Subtitle -->
      </div>
    </div>
  </section>
  <!-- End Hero -->

  <!--  Start Gamemodes Section -->
  <section class="section is-medium">
    <div class="container">
      <div class="content">

        <!-- Start Row -->
        <div class="columns">

          <!-- Start Column 1 -->
          <div id="leaderboard" class="column is-two-thirds">

            <!-- Start Card 1
            <div class="card">
              <a class="is-fullwidth has-text-black">
                <div class="card-content" style="padding: 1rem;">
                  <div class="content columns" style="font-size: 1.3em;">
                    <span class="has-text-left column"><big><strong>1. </strong></big> <img class="text-img" src="https://www.mc-heads.net/avatar/3299d57311c5493590f1d28abf4aacb2/150"> daisy1348</span><span class="has-text-right column">1200 IPP</span>
                  </div>
                </div>
              </a>
            </div>
            End Card 1 -->

            <!-- End Column 1 -->
          </div>

          <!-- Start Column 2 -->
          <div class="column">

            <!-- Start Card 1 -->
            <div class="card">
              <div class="card-content">
                <div class="content">
                  <a id="leaderboard-level" class="button card is-fullwidth" style="margin-top: 0.5em; margin-bottom: 0.5em;">전체 레벨 순위</a>
                  <a id="leaderboard-ipp" class="button card is-primary is-fullwidth" style="margin-top: 0.5em; margin-bottom: 0.5em;">IPP 순위 (Infinite PvP)</a>
                  <a class="button card is-primary is-fullwidth" href="#">준비중입니다 ...</a>
                </div>
              </div>
            </div>
            <!-- Start Card 1 -->
          </div>
          <!-- End Column 2 -->
        </div>
        <!-- End Row -->
      </div>
    </div>
  </section>
  <!-- End Gamemodes Section  -->


  <!-- Start Help Modal -->
  <div id="userInfo" class="modal">
    <div class="modal-background"></div>
    <div class="modal-card">
      <header class="modal-card-head">
        <!-- Start Help Modal Title -->
        <p class="modal-card-title">How to join <span class="server-name"></span></p>
        <button id="closeUserInfo2" class="delete" aria-label="close"></button>
        <!-- End Help Modal Title -->
      </header>
      <section class="modal-card-body">
        <div class="content">
          <!-- Start Help Modal Content -->
          <p id="user-profile-rank"></p>
          <p id="user-profile-level"></p>
          <p id="user-profile-coin"></p>
          <p id="user-profile-playtime"></p>
        </div>
        <!-- End Help Modal Content -->
      </section>
      <footer class="modal-card-foot">
        <!-- Start Help Modal Close Button -->
        <button id="closeUserInfo" class="button is-danger">닫기</button>
        <!-- End Help Modal Close Button -->
      </footer>
    </div>
  </div>
  <!-- End Help Modal -->

  <footer id="setup-footer" class="footer">
    <div class="content has-text-centered">
        <p>
        <strong>RedLime &copy; 2020-2021 &mdash; All rights
            reserved
        </strong>
        <br>
        <small>
            <span class="server-name"></span>
            server is in no way affiliated with Mojang, AB.</small>
        </p>
        <a href="./discord" target="_blank">
        <img width="180" src="https://discordapp.com/assets/fc0b01fe10a0b8c602fb0106d8189d9b.png" alt="Discord Logo">
        </a>
    </div>
  </footer>

  <script>
    var loadScore = 0;
    var nowMode = "";
    var nowPage = 0;
    function getData(target, page) {
      nowMode = target;
      nowPage = page;
      var time = ++loadScore;
      if (page == 1) $("#leaderboard").html("");

      $.ajax({
        url: "https://redlimerl.com/rlnetwork/api/v1/"+target+".php",
        data: { page: page },
        method: "GET",
        dataType: "json", 
      })
      .done(function(json) { 
        if (time == loadScore) {
          if (json.code == 200) {
            json.data.forEach(element => {
              var u = element.uuid.toString();
              $("#leaderboard").append(`<div class="card userInfoButton"><a class="is-fullwidth has-text-black" onclick="loadProfile('${u}')"><div class="card-content" style="padding: 1rem;"><div class="content columns" style="font-size: 1.3em;">`+
              `<span class="has-text-left column"><big><strong>${element.rank}. </strong></big> <img class="text-img" style="image-rendering: pixelated;" src="https://www.mc-heads.net/avatar/${u}/160"> ${element.nickname}</span>`+
              typeCase(target, element) + `</div></div></a></div>`);
            });
            $("#leaderboard").append(page<5 ? `<a id="leaderboard-more" class="button card is-primary is-fullwidth">더보기</a>` : ``);
          }
        }
      })
    }

    function typeCase(target, element) {
      if (target == "level_leaderboard") {
        return `<span class="has-text-right column">${element.level} Level <small><small>/ ${element.exp} exp</small></small></span>`
      }
      if (target == "ipp_leaderboard") {
        return `<span class="has-text-right column">${element.score} IPP</span>`
      }
      return ``
    }
    getData("level_leaderboard", 1);

    $(document).ready(function () {
      $(document).on("click", "#leaderboard-level", function() {
        getData("level_leaderboard", 1);
        $("#leaderboard-ipp").addClass("is-primary")
        $("#leaderboard-level").removeClass("is-primary")
      })
      $(document).on("click", "#leaderboard-ipp", function() {
        getData("ipp_leaderboard", 1);
        $("#leaderboard-level").addClass("is-primary")
        $("#leaderboard-ipp").removeClass("is-primary")
      })
      $(document).on("click", "#closeUserInfo", function() {
        $("#userInfo").removeClass("is-active")
      })
      $(document).on("click", "#closeUserInfo2", function() {
        $("#userInfo").removeClass("is-active")
      })
      $(document).on("click", "#leaderboard-more", function() {
        $("#leaderboard-more").remove();
        if (nowPage < 5) getData(nowMode, nowPage+1);
      })
    });
    
    function loadProfile(uuid) {
      $("#userInfo").addClass("is-active");
      $(".modal-card-title").html("불러오는 중...");
      $("#user-profile-rank").html(``);
      $("#user-profile-level").html(``);
      $("#user-profile-coin").html(``);
      $("#user-profile-playtime").html(``);
      $.ajax({
        url: "https://redlimerl.com/rlnetwork/api/v1/user_profile.php",
        data: { uuid: uuid },
        method: "GET",
        dataType: "json", 
      })
      .done(function(json) { 
        if (json.code == 200) {
          var user = json.data;
          $(".modal-card-title").html(`<img class="text-img" style="image-rendering: pixelated;" src="https://www.mc-heads.net/avatar/${uuid}/160"> `+user.nickname+"님의 정보");
          $("#user-profile-rank").html(`<big>등급 : </big>${user.grade}`);
          $("#user-profile-level").html(`<big>레벨 : </big>${user.level} Level <small>/ ${user.exp} exp</small> (#${user.rank})`);
          $("#user-profile-coin").html(`<big>보유중인 코인 : </big>${user.coins}`);
          $("#user-profile-playtime").html(`<big>플레이타임 : </big>${time(user.playtime)}`);
        }
      })
    }

    function time(a) {
      var sec_num = parseInt(a, 10); // don't forget the second param
      var hours   = Math.floor(sec_num / 3600);
      var days   = Math.floor(hours / 24);
      var minutes = Math.floor((sec_num - (hours * 3600)) / 60);
      var seconds = sec_num - (hours * 3600) - (minutes * 60);

      if (days   < 10) {days   = "0"+days;}
      if (hours   < 10) {hours   = "0"+hours;}
      if (minutes < 10) {minutes = "0"+minutes;}
      if (seconds < 10) {seconds = "0"+seconds;}
      
      return days+'일 '+hours+'시간 '+minutes+'분';
    }
  </script>
</body>

</html>